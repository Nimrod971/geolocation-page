
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Localisations des utilisateurs</title>
<style>
    #locations {
        margin-top: 20px;
        font-family: Arial, sans-serif;
        font-size: 16px;
    }
</style>
</head>
<body>
    <h1>Localisations des utilisateurs</h1>

    <div>
        <label for="name">Entrez votre nom :</label>
        <input type="text" id="name" placeholder="Votre nom">
        <button onclick="submitName()">Confirmer</button>
    </div>

    <div id="locations"></div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.9.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.9.2/firebase-database-compat.js"></script>

    <script type="module">

         // Import the functions you need from the SDKs you need
        import { initializeApp } from "firebase/app";
        import { getAnalytics } from "firebase/analytics";

        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries


        // Configuration Firebase ()
        const firebaseConfig = {
          apiKey: "AIzaSyC88wjBSOkwv32S9J3ae7PG62Yg8nBdhkk",
          authDomain: "localisation-f612e.firebaseapp.com",
          projectId: "localisation-f612e",
          storageBucket: "localisation-f612e.appspot.com",
          messagingSenderId: "348219277594",
          appId: "1:348219277594:web:5e89c49820d5dde154eca3",
          measurementId: "G-5CPF14NMDG"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);


        // Initialiser Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        document.addEventListener("DOMContentLoaded", (event) => {
            loadLocations();
        });

        function submitName() {
            var name = document.getElementById("name").value;
            if (name) {
                getLocation(name);
            } else {
                alert("Veuillez entrer votre nom.");
            }
        }

        function getLocation(name) {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    showPosition(position, name);
                });
            } else {
                alert("La géolocalisation n'est pas supportée par votre navigateur.");
            }
        }

        function showPosition(position, name) {
            var latitude = position.coords.latitude;
            var longitude = position.coords.longitude;

            var locationData = {
                name: name,
                latitude: latitude,
                longitude: longitude
            };

            saveLocation(locationData);
            appendLocation(locationData);
        }

        function saveLocation(locationData) {
            var newLocationKey = firebase.database().ref().child('locations').push().key;
            var updates = {};
            updates['/locations/' + newLocationKey] = locationData;
            return firebase.database().ref().update(updates);
        }

        function loadLocations() {
            firebase.database().ref('/locations/').on('value', function(snapshot) {
                document.getElementById("locations").innerHTML = ""; // Clear current locations
                snapshot.forEach(function(childSnapshot) {
                    var locationData = childSnapshot.val();
                    appendLocation(locationData);
                });
            });
        }

        function appendLocation(locationData) {
            var locationElement = document.createElement("p");
            locationElement.textContent = locationData.name + " - Latitude: " + locationData.latitude + ", Longitude: " + locationData.longitude;
            document.getElementById("locations").appendChild(locationElement);
        }
    </script>
</body>
</html>
